
@{
    ViewData["Title"] = "PayDate";
    Layout = "~/Views/Shared/_Layout.cshtml";

    int x1=0, x2=0, x3=0, x4 = 0;
    int f1 = 0;
    int p1 = 0, p2 = 0, p3 = 0, p4 = 0, p5 = 0;
    int p6 = 0, p7 = 0, p8 = 0, p9 = 0, p10 = 0, p11 = 0, p12 = 0, p13 = 0, p14 = 0;

    int all = 0;
    int qw1 = 0, qw2 = 0, qw3 = 0;
    int py1 = 0, py2 = 0, py3 = 0;
    var yest = DateTime.Now.AddDays(-1).AddHours(14);
    var yestyest = DateTime.Now.AddDays(-2).AddHours(14);
}

<h2>Статистика продажи</h2>


<ul>
    <li>
        Сентябрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2019-09-01") && d.txn_date <= Convert.ToDateTime("2019-09-30")) { p1++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2019-09-01") && d.date <= Convert.ToDateTime("2019-09-30")) { p1++; } }
        @p1;
    </li>
    <li>
        Октябрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2019-10-01") && d.txn_date <= Convert.ToDateTime("2019-10-30")) { p2++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2019-10-01") && d.date <= Convert.ToDateTime("2019-10-30")) { p2++; } }
        @p2;
    </li>
    <li>
        Ноябрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2019-11-01") && d.txn_date <= Convert.ToDateTime("2019-11-30")) { p3++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2019-11-01") && d.date <= Convert.ToDateTime("2019-11-30")) { p3++; } }
        @p3;
    </li>
    <li>
        Декабрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2019-12-01") && d.txn_date <= Convert.ToDateTime("2019-12-30")) { p4++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2019-12-01") && d.date <= Convert.ToDateTime("2019-12-30")) { p4++; } }
        @p4;
    </li>
    <li>
        Январь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-01-01") && d.txn_date <= Convert.ToDateTime("2020-01-30")) { p5++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-01-01") && d.date <= Convert.ToDateTime("2020-01-30")) { p5++; } }
        @p5;
    </li>
    <li>
        Февраль::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-02-01") && d.txn_date <= Convert.ToDateTime("2020-02-29")) { p6++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-02-01") && d.date <= Convert.ToDateTime("2020-02-29")) { p6++; } }
        @p6;
    </li>
    <li>
        Март::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-03-01") && d.txn_date <= Convert.ToDateTime("2020-03-31")) { p7++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-03-01") && d.date <= Convert.ToDateTime("2020-03-31")) { p7++; } }
        @p7;
    </li>
    <li>
        Апрель::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-04-01") && d.txn_date <= Convert.ToDateTime("2020-04-30")) { p8++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-04-01") && d.date <= Convert.ToDateTime("2020-04-30")) { p8++; } }
        @p8;
    </li>
    <li>
        Май::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-05-01") && d.txn_date <= Convert.ToDateTime("2020-05-31")) { p9++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-05-01") && d.date <= Convert.ToDateTime("2020-05-31")) { p9++; } }
        @p9;
    </li>
    <li>
        Маусым::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-06-01") && d.txn_date <= Convert.ToDateTime("2020-06-30")) { p10++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-06-01") && d.date <= Convert.ToDateTime("2020-06-30")) { p10++; } }
        @p10;
    </li>

    <li>
        Шілде::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-07-01") && d.txn_date <= Convert.ToDateTime("2020-07-31")) { p11++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-07-01") && d.date <= Convert.ToDateTime("2020-07-31")) { p11++; } }
        @p11;
    </li>

    <li>
        Тамыз::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-08-01") && d.txn_date <= Convert.ToDateTime("2020-08-31")) { p12++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-08-01") && d.date <= Convert.ToDateTime("2020-08-31")) { p12++; } }
        @p12;
    </li>

    <li>
        Сентябрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-09-01") && d.txn_date <= Convert.ToDateTime("2020-09-30")) { p13++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-09-01") && d.date <= Convert.ToDateTime("2020-09-30")) { p13++; } }
        @p13;
    </li>
    <li>
        Октябрь::
        @foreach (var d in ViewBag.Qiwi) { if (d.pay == true && d.txn_date >= Convert.ToDateTime("2020-10-01") && d.txn_date <= Convert.ToDateTime("2020-10-31")) { p14++; } }
        @foreach (var d in ViewBag.Paybox) { if (d.success == true && d.date >= Convert.ToDateTime("2020-10-01") && d.date <= Convert.ToDateTime("2020-10-31")) { p14++; } }
        @p14;
    </li>
</ul>


<hr />

<ul>
    <li>Счета по Qiwi::: @foreach (var d in ViewBag.Qiwi) { x1++; } @x1</li>
    <li>Оплата по qiwi::: @foreach (var d in ViewBag.Qiwi) { if (d.pay == true) { x2++; if (d.txn_date >= yestyest && d.txn_date < yest) { qw1++; }
            if(d.txn_date >= yest){qw2++;} }
        } @x2</li>
</ul>
<hr />
<ul>
    <li>Счета по Paybox::: @foreach (var d in ViewBag.Paybox) { x3++; } @x3</li>
    <li>Оплата по Paybox::: @foreach (var d in ViewBag.Paybox) { if (d.success == true) { x4++; if (d.date >= yestyest && d.date < yest) { py1++; } if (d.date >= yest) { py2++; }  } } @x4</li>
</ul>
<hr />


        
<div class="row">
    <div class="col-md-4">
        <p>Qiwi за перед вчера - @qw1</p>
        <p>Qiwi за вчера и сегодня - @qw2</p>
        <p></p>
    </div>
    <div class="col-md-4">
        <p>Paybox за перед вчера - @py1</p>
        <p>Paybox за вчера и сегодня - @py2</p>
        <p></p>
    </div>
</div>

<hr />
<ul>
    Привязки

        @foreach(var d in ViewBag.Qiwi)
        {
            if(d.pay == false)
            {
                foreach(var f in ViewBag.Paybox)
                {
                    if(d.UserId == f.IdentityId && d.type == f.type)
                    {
                        f1++;
                    }
                }
            }
        }

    <li>@f1</li>
</ul>
<hr />
<h2>В итоге</h2>
<p>Онлайн оплата::: @{ all =  x2 + x4; } @all</p>